using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;

namespace BlazeUI.Blaze;

public static class MagicNumbers
{
    // generate a magic number with a push of at least 48
    // reused code from my previous attempt
    private static (ulong magicNumber, int push, int highest) GenerateMagicNumber(ulong[] combinations, int minPush, bool tryImprove, bool log)
    {
        Console.WriteLine($"Generating magic numbers for {combinations.Length} combinations");
        
        ulong magicNumber;
        int push = 0;
        int attempts = 0;

        ulong[] results = new ulong[combinations.Length];

        while (true) // keep generating magic numbers until one is found
        {
            // generate random ulong
            ulong candidateNumber = RandomUlong();
            // multiply every combination with the magic number and push them right by minPush, only leaving the leftmost 64 - minPush bits
            for (int i = 0; i < combinations.Length; i++)
                results[i] = (combinations[i] * candidateNumber) >> minPush;
            

            // if the result array contains duplicates, the number isn't magic, so don't bother checking it for further pushes
            if (results.Length == new HashSet<ulong>(results).Count)
            {
                if (tryImprove)
                {
                    ulong[] temp = (ulong[])results.Clone();

                    for (int i = 0; i < 16; i++)
                    {
                        // push further right by a certain amount, and check for duplicates again
                        for (int j = 0; j < temp.Length; j++)
                        {
                            temp[j] >>= 1;
                        }

                        // if there are no duplicates in temp
                        if (!temp.GroupBy(x => x).Any(g => g.Count() > 1))
                        {
                            if (i == 0)
                                continue;
                            for (int j = 0; j < results.Length; j++)
                            {
                                results[j] >>= 1;
                            }

                            push++;
                        }
                        else break;
                    }
                }

                magicNumber = candidateNumber;
                break;
            }

            attempts++;
            if (log || attempts % 1000 == 0) Console.WriteLine($"attempts: {attempts}");
        }

        Console.WriteLine($"magic number found in {attempts} attempts");
        return (magicNumber, push + minPush, (int)results.Max());
    }

    public static (ulong magicNumber, int push, int highest)[,] Presets(string type)
    {
        return type == "rook" ? RookNumbers : BishopNumbers;
    }

    public static (ulong magicNumber, int push, int highest) GenerateRepeat(ulong[] combinations, int iterations, int minPush = 48, bool tryImprove = true, bool log = false)
    {
        (ulong magicNumber, int push, int highest) magicNumber = (0, 0, 0);
        
        for (int i = 0; i < iterations; i++)
        {
            (ulong magicNumber, int push, int highest) New = GenerateMagicNumber(combinations, minPush, tryImprove, log);
            if (New.push > magicNumber.push || (New.push == magicNumber.push && New.highest < magicNumber.highest))
                magicNumber = New;
        }
        
        return magicNumber;
    }

    public static (ulong magicNumber, int push, int highest) GenerateMagicNumberParallel(ulong[] combinations, int push, int threads = 5, bool log = true)
    {
        Mutex mut = new();
        bool found = false;
        ulong magicNumber = 0;
        int highest = 0;
        int totalAttempts = 0;

        Console.WriteLine($"Generating magic numbers parallel for {combinations.Length} combinations");
        
        Parallel.For(1, threads + 1, (i) =>
        {
            int attempts = 0;
            
            while (true)
            {
                mut.WaitOne();
                if (found)
                    break;
                ulong candidateNumber = RandomUlong();
                attempts++;
                totalAttempts++;
                if (log)
                    Console.WriteLine($"Attempt {attempts} on thread {i}");
                if (totalAttempts % 1000 == 0) 
                    Console.WriteLine($"Total attempts: {totalAttempts}");

                mut.ReleaseMutex();

                (bool isMagic, int highest) result = IsMagic(candidateNumber, push, combinations);
                
                if (result.isMagic)
                {
                    mut.WaitOne();
                    Console.WriteLine($"Magic number found: {(candidateNumber, push, result.highest)} in a total of {totalAttempts} attempts on thread {i}");
                    found = true;
                    magicNumber = candidateNumber;
                    highest = result.highest;
                    mut.ReleaseMutex();
                    break;
                }
            }
        });
        
        return (magicNumber, push, highest);
    }

    private static (bool isMagic, int highest) IsMagic(ulong number, int push, ulong[] combinations)
    {
        ulong[] results = new ulong[combinations.Length];
        for (int i = 0; i < results.Length; i++)
            results[i] = (combinations[i] * number) >> push;
        
        if (results.Length == new HashSet<ulong>(results).Count)
            return (true, (int)results.Max());
        return (false, 0);
    }
    
    private static readonly Random RandGen = new();
    
    private static ulong RandomUlong()
    {
        while (true)
        {
            var buffer = new byte[sizeof(ulong)];
            RandGen.NextBytes(buffer);
            return BitConverter.ToUInt64(buffer, 0);
        }
    }
    
    public static readonly (ulong magicNumber, int push, int highest)[,] RookNumbers =
    {
        {
            (9923146022150792333, 47, 131063), (7668639886525986227, 47, 131063), (3629133785401589564, 47, 131068),
            (8706199993787762013, 47, 131067), (4396951879642956839, 47, 131069), (7885189970349236347, 47, 131069),
            (8990451101724604215, 47, 131061), (16059615410457403175, 47, 131056)
        },
        {
            (10712629561810192067, 47, 131068), (14843800520682277201, 47, 131056), (6285520896410588276, 47, 131055),
            (8270101362211238580, 47, 131067), (8229251433712028980, 47, 131069), (5726635721214408384, 47, 131064),
            (7471020051712059711, 47, 131060), (17312941723611444032, 47, 131057)
        },
        {
            (10715252403639884213, 47, 131062), (11409318459344639724, 47, 131068), (2222750398276542267, 47, 131062),
            (7753106238748319563, 47, 131056), (6691691767285863855, 47, 131051), (7877962418500077873, 47, 131067),
            (16993505339122534095, 47, 131067), (4967773378019534508, 47, 131070)
        },
        {
            (11963741368578664693, 47, 131066), (13474550921401300912, 47, 131050), (17340298881836925584, 47, 131064),
            (5411817082414614704, 47, 131053), (8794041926648487619, 47, 131060), (16067264871037795984, 47, 131070),
            (13910088726049108097, 47, 131070), (17506012352560819798, 47, 131061)
        },
        {
            (10864742200142962995, 47, 131063), (12608786547983708161, 47, 131068), (4683822216344260380, 47, 131070),
            (14021165370022003016, 47, 131061), (12410192527782123140, 47, 131070), (7777158592475981146, 47, 131063),
            (7346486222795146463, 47, 131060), (17589453255629190735, 47, 131068)
        },
        {
            (11590144183714373861, 47, 131067), (3521610362190403860, 47, 131060), (10491928793291436471, 47, 131070),
            (4408591932620834412, 47, 131070), (13950220737264665292, 47, 131067), (13098831028647604330, 47, 131064),
            (8831035641484358884, 47, 131058), (10233972736420509612, 47, 131066)
        },
        {
            (3716118917611328159, 47, 131068), (4343630920230470798, 47, 131059), (8293045590004304366, 47, 131070),
            (13644446753367196113, 47, 131055), (351468507416230794, 47, 131070), (13133405702460555318, 47, 131050),
            (9463629074782913314, 47, 131070), (16725758379878316038, 47, 131054)
        },
        {
            (13163919743207779162, 47, 131061), (2801036098447367307, 47, 131070), (544047300546714195, 47, 131058),
            (491686857891303791, 47, 131056), (6433024462075745127, 47, 131065), (1779621975361617255, 47, 131070),
            (12515787739068253761, 47, 131068), (11308302871681451565, 47, 131070)
        }
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] BishopNumbers =
    {
        {
            (10984437588327355704, 51, 8188), (7006058535829348525, 52, 4044), (14906122406994150172, 49, 32619),
            (2066184340015723333, 51, 8150), (1035297900335743484, 52, 4091), (16607782446796926046, 51, 8156),
            (1247444761181602811, 50, 16171), (15870182710494725, 52, 4082)
        },
        {
            (4603830292560296292, 49, 32693), (15855686154953055350, 49, 32707), (7251151001245687602, 47, 130314),
            (16114471141749563029, 51, 8176), (11401233933306946887, 47, 131070), (7195318184353575418, 50, 16367),
            (1649467647888140695, 48, 65305), (11124515084308147271, 51, 8177)
        },
        {
            (11070954177618850525, 53, 2039), (12428895035525312174, 48, 65447), (3141906513735950133, 47, 131021),
            (1970064370294220711, 47, 131024), (2348266627463219689, 47, 130967), (9653558686444912649, 47, 131026),
            (3182850852236480546, 48, 65428), (14615239119142771435, 49, 32443)
        },
        {
            (10973662793716665623, 53, 2030), (9641991183283297038, 48, 65287), (6334974661080060926, 47, 131048),
            (13260876134096857530, 47, 131054), (9398778627118995277, 47, 131053),
            (12206312023251063905, 47, 131070),
            (2084885181953242666, 47, 129879), (16814179508889275684, 52, 4093)
        },
        {
            (16484429464892923043, 52, 4076), (13829589210862379486, 49, 32760), (2596932861749656247, 47, 131040),
            (6043126200206940745, 47, 131031), (12535698615780334274, 47, 131055),
            (15886806933826500261, 47, 130966),
            (1092213874886853380, 50, 16356), (16477038996506879131, 49, 32754)
        },
        {
            (10150045531924313354, 51, 8106), (17054948454648592514, 48, 65528), (17345459729335561269, 47, 130834),
            (13621686841573233274, 47, 131070), (18160237639046435887, 47, 130946),
            (14602156085682375156, 47, 130968),
            (12104214529036088946, 49, 32764), (8861481076252219696, 52, 4091)
        },
        {
            (11410533049506724456, 51, 8046), (8297625402410663567, 48, 65467), (2373818184025873052, 50, 16343),
            (15252246013694177531, 47, 130730), (8797671975670280739, 50, 16358), (2976335728957827031, 47, 130861),
            (18145425317785678925, 49, 32446), (9579073613274333698, 49, 32682)
        },
        {
            (11809129073957181761, 48, 65534), (15444082618789063762, 53, 2034), (17793945967432013766, 52, 4090),
            (13606051810055179660, 51, 8017), (4523306322104149711, 50, 16381), (12569790028625216797, 50, 16350),
            (15377014312014850010, 51, 8169), (16665806180439125489, 50, 16326)
        }
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] RookCaptureNumbers =
    {
        {
            (6365506759266989005, 55, 496), (6029977868635599997, 54, 1014), (14192715539234118131, 53, 2038),
            (12815662641569804658, 52, 3955), (7014040585053618051, 52, 3795), (9403798673297552080, 53, 1981),
            (9154323346461036164, 53, 1991), (5218803728313855311, 55, 507),
        },
        {
            (14354122580399818089, 54, 1019), (3410872916239446861, 52, 4029), (6606290226706934274, 51, 8094),
            (4076748640786620224, 51, 8127), (7355468799506760983, 51, 8091), (2197927504423765608, 51, 8054),
            (13360933451215740637, 52, 3992), (50842642160801382, 53, 1998),
        },
        {
            (17845158226327552023, 53, 1978), (10549256009348072116, 52, 4065), (9581239729770909748, 51, 8135),
            (9343521415148273252, 51, 8149), (9541728226624195941, 51, 8108), (10073503080918341880, 51, 8147),
            (7150005233099601246, 52, 4075), (2069934116452246811, 53, 2018),
        },
        {
            (3634904962137087757, 53, 2031), (3400674308757764728, 52, 4083), (3279546804335051098, 51, 8159),
            (11786490382481896418, 51, 8188), (9387709098370104733, 51, 8164), (13643811338099281333, 51, 8152),
            (4730698058985461337, 51, 8099), (1913791046965223053, 52, 4000),
        },
        {
            (4472355392500172519, 53, 2024), (8711759663644732472, 52, 4090), (9881725329467664129, 51, 8150),
            (16701595604386074327, 51, 8168), (10656089175884224518, 50, 16096), (16116647111295968292, 51, 8155),
            (11216363851367386734, 52, 4094), (398149933635817308, 53, 2022),
        },
        {
            (2124598123731226401, 54, 1022), (11150996385026051076, 52, 3982), (5801100673792635780, 51, 8143),
            (2557770223483682876, 51, 8170), (15272229891916278081, 51, 8138), (10805005383042467137, 51, 8081),
            (15233470661909096814, 52, 4065), (3763198055730955365, 53, 1982),
        },
        {
            (8426196552506341837, 54, 1006), (10298434762755408150, 53, 2042), (5959557948132306849, 51, 8009),
            (18289639977447624478, 51, 8104), (13728122032349526762, 52, 4084), (17322099047927750109, 52, 4085),
            (16323200198794286465, 52, 4057), (9421722632379267211, 53, 2003),
        },
        {
            (14213754848228836823, 55, 505), (1621117018522215127, 54, 998), (8552091727934563033, 53, 2037),
            (8836899782813923095, 53, 2033), (13424007385708200479, 52, 4033), (14794995212617979907, 53, 2020),
            (11146345037874782169, 54, 1016), (12403559635138225803, 55, 492),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] BishopCaptureNumbers =
    {
        {
            (4531256109720873438, 60, 14), (4812441701031401761, 59, 30), (3157363529310176433, 58, 53),
            (18034443901115965858, 58, 59), (4198526309144709406, 58, 62), (14934457620075084082, 58, 54),
            (6011254840080595807, 58, 48), (16768495066172472235, 60, 14),
        },
        {
            (2020639645255214466, 58, 50), (11462131694845437612, 56, 242), (7622934054080074224, 55, 508),
            (4272038279783415281, 55, 507), (3974975881916912150, 55, 502), (13074274388064719181, 55, 500),
            (7822934599787224043, 56, 253), (14060247379787798696, 59, 30),
        },
        {
            (13133236342628211684, 58, 58), (10962313318763382576, 55, 501), (4104764194708594726, 52, 3979),
            (5344448220646557577, 52, 4047), (3409021303930996993, 52, 4018), (357301957021474647, 53, 2046),
            (10143514316913593362, 55, 504), (989059063207646148, 58, 60),
        },
        {
            (15275176563279764852, 58, 63), (17680648474909450248, 55, 500), (9839287864672063660, 52, 4019),
            (13461277021870320366, 51, 8083), (7055868717702392095, 50, 16134), (16215910662519339311, 52, 4028),
            (6395153342815476750, 55, 511), (16072573903047120673, 58, 61),
        },
        {
            (9961876418850262824, 58, 61), (2638381662360219621, 55, 492), (15569833041918338622, 52, 3995),
            (17019139431905442537, 51, 8166), (3773846531784669180, 51, 8168), (14914868257142775220, 52, 4027),
            (10632953591833814883, 54, 978), (8428620406901423245, 58, 63),
        },
        {
            (9061263986855753956, 58, 60), (1010174032934215350, 55, 481), (2168549760196154831, 53, 2031),
            (17135402551437438137, 52, 4001), (15995648229794577866, 52, 4010), (11435614281813930442, 52, 3947),
            (13940488918110342226, 55, 501), (14058762109275634803, 58, 58),
        },
        {
            (10754985091151770692, 59, 30), (16016517170259334375, 56, 242), (8715795921151230648, 55, 488),
            (9967045883588759347, 54, 987), (3592445657316852657, 54, 979), (3226497030056102353, 55, 503),
            (12529533971275225126, 55, 481), (3676138319215110012, 58, 50),
        },
        {
            (11397095792702253880, 60, 14), (16794280908572821982, 59, 28), (14764070685454054756, 58, 51),
            (7886511472470998303, 58, 60), (17518209088286365080, 58, 63), (1812908823142552336, 58, 56),
            (17955836336929950888, 58, 51), (5775188448546953675, 60, 14),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] KnightNumbers =
    {
        {
            (4213676592776040603, 61, 6), (808408947955507185, 60, 14), (16963565108934586562, 59, 30),
            (573115046082495782, 59, 30), (12156813312854239751, 59, 30), (14074099221382392032, 59, 30),
            (2888185195808407391, 60, 14), (10475772087203011374, 61, 6),
        },
        {
            (2469661812558223614, 60, 14), (8239392681613658638, 59, 30), (6286539138790868484, 56, 200),
            (15556548148750665240, 56, 246), (7404718928578338643, 56, 236), (6762987143332244783, 56, 248),
            (16730202879017778776, 59, 30), (39230985230081057, 60, 14),
        },
        {
            (6952325437502511, 59, 30), (3920170366468096180, 56, 246), (1271271514612533967, 53, 2019),
            (9602032458780865690, 53, 2031), (4070371430365924078, 53, 2032), (4771335980013109165, 53, 2031),
            (13774237551004564925, 56, 245), (9553278973925469675, 59, 30),
        },
        {
            (15166462884268499094, 59, 30), (6175404168450639348, 56, 243), (8513515329442144280, 54, 1021),
            (7002917578961288694, 53, 2017), (2376946087991284407, 53, 2032), (4534647674833750750, 53, 2021),
            (9954597193904699111, 56, 248), (14590000767461115766, 59, 30),
        },
        {
            (8055173476809312782, 59, 30), (11090869709082870435, 57, 126), (7499630584370057330, 54, 981),
            (3296989605669134658, 53, 2023), (16500173358649078557, 53, 2032), (13344864798714543066, 53, 2021),
            (5463632756021360379, 56, 250), (7054049079284663758, 59, 30),
        },
        {
            (3551619717381884548, 59, 30), (4221346403705405205, 56, 236), (16288262982767754982, 54, 1017),
            (1324099807659685995, 53, 2028), (6930368457193127972, 53, 2028), (1008094912519895388, 53, 2025),
            (16321906157804397369, 56, 242), (6354650574294438347, 59, 30),
        },
        {
            (10558821836590494625, 60, 14), (8793859125239129640, 59, 30), (9755983088764294933, 57, 126),
            (4589120049736448047, 56, 245), (8787661853325006163, 56, 239), (6577023664294630843, 56, 247),
            (4404569093463347202, 59, 30), (14023104255707510421, 60, 14),
        },
        {
            (10676862309737651292, 61, 6), (5616990624400221206, 60, 14), (17791272422881628553, 59, 30),
            (14036046260490357260, 59, 30), (11762140548173728179, 59, 30), (7303994849371872528, 59, 30),
            (4797273506439055731, 60, 14), (5646966869293985530, 61, 6),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] KingNumbers =
    {
        {
            (2110450308958602198, 60, 14), (2818866612791197913, 58, 62), (6611889612521214269, 58, 62),
            (8479689179966978026, 58, 62), (17584375646680530737, 58, 62), (6359193113664043896, 58, 62),
            (4691573928558046222, 58, 62), (15150388903847750655, 60, 14),
        },
        {
            (5199960015383633938, 58, 62), (10695973319595524737, 54, 922), (15120420590223107333, 54, 1016),
            (522754086792477651, 54, 1005), (1679660322492961614, 54, 998), (7214126561997178742, 54, 1011),
            (2730276924530782662, 54, 1016), (9372209917432506957, 58, 63),
        },
        {
            (3707161399472353307, 58, 62), (14423079475113148466, 54, 1005), (4000178572439339865, 54, 987),
            (5235041708923701273, 54, 1015), (2772988018294064943, 54, 1015), (362542075316868662, 54, 1006),
            (20275744369891284, 54, 1008), (13335213818908481732, 58, 63),
        },
        {
            (9540502278189355288, 58, 62), (10293365349487481128, 54, 994), (12092437779965822781, 54, 1011),
            (4816693718315558568, 54, 1012), (1631306483734011274, 54, 1011), (15101531479219809933, 54, 1016),
            (13947956781744457454, 54, 1014), (12110484169313237798, 58, 63),
        },
        {
            (2059812440713420937, 57, 66), (12515670379503505247, 54, 992), (7112488615688482656, 54, 997),
            (9582803241734009963, 54, 1012), (5620218014933533422, 54, 1018), (5510312493059312836, 54, 1018),
            (2581094718123234099, 54, 1011), (14286566650061174351, 58, 62),
        },
        {
            (13608792375486610502, 58, 62), (5623721625481914382, 54, 983), (7300305881875226841, 54, 1015),
            (6403466111320873017, 54, 977), (10195674301538108573, 54, 1015), (1996153097014676447, 54, 1016),
            (15997355665052632358, 54, 1003), (12114964898291359634, 58, 62),
        },
        {
            (11234684274728877603, 58, 62), (6644879040106635283, 55, 511), (4937989032574816606, 54, 1018),
            (13806922824112196561, 54, 1013), (16706483719831657337, 54, 1006), (7141740152243585516, 54, 1017),
            (1517492648617939737, 54, 1015), (10835943917450760176, 58, 63),
        },
        {
            (14624564417431463322, 60, 14), (12669931155572581253, 58, 62), (10687320650953123587, 58, 62),
            (13011260460470174247, 58, 63), (747361160914997856, 58, 63), (10658544373956545143, 58, 62),
            (8864885346442875003, 58, 63), (9966332368594430056, 60, 14),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] WhitePawnMoveNumbers =
    {
        {
            (0, 0, 0), (8047926772652126443, 61, 6), (12866577292407332724, 62, 2), (10812507807119045072, 62, 2),
            (14097564359315171329, 62, 2), (16543435175962060965, 62, 2), (10913650316772197663, 62, 2), (0, 0, 0),
        },
        {
            (0, 0, 0), (17507829843214607903, 61, 6), (1922892310352020573, 62, 2), (11235400025654654944, 62, 2),
            (7441288710241201652, 62, 2), (2186574074996962852, 62, 2), (6322184532432047239, 62, 2), (0, 0, 0),
        },
        {
            (0, 0, 0), (13106742958268471389, 61, 6), (931129238296778098, 62, 2), (6153257269042365637, 62, 2),
            (14096243317563776819, 62, 2), (6478596592041456920, 62, 2), (16837441836483551019, 62, 2), (0, 0, 0),
        },
        {
            (0, 0, 0), (10725961513424847125, 61, 6), (7789181260675273784, 62, 2), (11375592468998576127, 62, 2),
            (11416047339692391258, 62, 2), (8473099546890487176, 62, 2), (17513779829434349205, 62, 2), (0, 0, 0),
        },
        {
            (0, 0, 0), (6603989290709459369, 61, 6), (15294735802244884627, 62, 2), (289202942604919289, 62, 2),
            (10162190759871368646, 62, 2), (17251713378544231705, 62, 2), (14690220499914684710, 62, 2), (0, 0, 0),
        },
        {
            (0, 0, 0), (9753284077454982725, 61, 6), (6898359592912780498, 62, 2), (9529057831926416608, 62, 2),
            (9985111455648020910, 62, 2), (17562990212659049952, 62, 2), (7207800034103895087, 62, 2), (0, 0, 0),
        },
        {
            (0, 0, 0), (9071533318986863595, 61, 6), (6576752775487380030, 62, 2), (1114021997321381849, 62, 2),
            (16660661008134401656, 62, 2), (9133911132873454505, 62, 2), (11102942519843636854, 62, 2), (0, 0, 0),
        },
        {
            (0, 0, 0), (8884923474759715363, 61, 6), (5075702834520870552, 62, 2), (15727364935946987731, 62, 2),
            (13099937205817349535, 62, 2), (7806758876336769619, 62, 2), (10044681464147873019, 62, 2), (0, 0, 0),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] BlackPawnMoveNumbers =
    {
        {
            (0, 0, 0), (3712018666414798747, 62, 2), (9425196869250431498, 62, 2), (16514871253408373077, 62, 2),
            (795240582136275043, 62, 2), (17208582423226575504, 62, 2), (8283755382860368477, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (3856394437144254547, 62, 2), (12685660021318796588, 62, 2), (357198541088074656, 62, 2),
            (15701062565843430592, 62, 2), (13249334288384506272, 62, 2), (950443428658768767, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (5299426692310158828, 62, 2), (5996908831736324612, 62, 2), (11053355638186769284, 62, 2),
            (10222951528516277648, 62, 2), (11417894854598106728, 62, 2), (7839396205605774167, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (6572525119287142963, 62, 2), (6450877965144092710, 62, 2), (18286984479825572068, 62, 2),
            (3285696361025286395, 62, 2), (8864247308327787574, 62, 2), (8718114112088073313, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (11567944210939447736, 62, 2), (17917891276143487913, 62, 2), (9776022676242593666, 62, 2),
            (15738387378269162131, 62, 2), (14396824633586173364, 62, 2), (7381907460076783409, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (4916573709424784333, 62, 2), (10780884375124444543, 62, 2), (17688800347864519790, 62, 2),
            (5475339935449362376, 62, 2), (17730400899215202763, 62, 2), (14920736024595084511, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (15546251608132438010, 62, 2), (1025181755289947828, 62, 2), (1162311564235534042, 62, 2),
            (2144327297975824033, 62, 2), (9040108540560580590, 62, 2), (2867656346960905542, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (9563048923544889183, 62, 2), (7507081231690064702, 62, 2), (17650676227637188776, 62, 2),
            (14516068084456548876, 62, 2), (16182943568537505982, 62, 2), (12312209768363508002, 61, 6), (0, 0, 0),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] WhiteCaptureMoveNumbers =
    {
        {
            (0, 0, 0), (14574068437667021730, 61, 6), (2121005558504459460, 61, 6), (14796347212663092299, 61, 6),
            (5377128524660225188, 61, 6), (532860927509239306, 61, 6), (2550510258572042891, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (8723622396442071995, 61, 6), (3810616419059906597, 61, 6), (7214265993105923215, 61, 6),
            (17196029563436575822, 61, 6), (7535383234730382809, 61, 6), (12879620004064526090, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (17986455013837850587, 61, 6), (5818556434502523018, 61, 6), (2758810774352229402, 61, 6),
            (8176241836916994586, 61, 6), (277007504753895207, 61, 6), (5204821283713695027, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (6486930271066934641, 61, 6), (4541182511806453396, 61, 6), (2267939459387136731, 61, 6),
            (12997006311102409830, 61, 6), (9487976944146149360, 61, 6), (12397911750753636339, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (5182894324200129392, 61, 6), (7742108612393134442, 61, 6), (17287164434606661712, 61, 6),
            (2857839666672718530, 61, 6), (4311677518910186665, 61, 6), (8519454733316522609, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (9645694409941527416, 61, 6), (5375196417534687279, 61, 6), (13151213470592473015, 61, 6),
            (16120873496394129873, 61, 6), (8100059368349506129, 61, 6), (17949838895680408256, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (18185250564536570516, 61, 6), (17271410373534945486, 61, 6), (1634690582801163805, 61, 6),
            (12903549116396625164, 61, 6), (11402145077166056255, 61, 6), (1482792901925914856, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (17557250831442398130, 61, 6), (10810133710524129263, 61, 6), (14291313746670101124, 61, 6),
            (8844624142514005813, 61, 6), (9394017788717588421, 61, 6), (7944550869157174816, 61, 6), (0, 0, 0),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] BlackCaptureMoveNumbers =
    {
        {
            (0, 0, 0), (9836703480273802018, 61, 6), (14213945641100994049, 61, 6), (18220872116459558620, 61, 6),
            (6496510156091052329, 61, 6), (1603722520132794968, 61, 6), (9822111275473167705, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (9728259606081179282, 61, 6), (1798649946193572349, 61, 6), (750964600346979427, 61, 6),
            (7238076772217589574, 61, 6), (6749779363444025008, 61, 6), (12697813075529509732, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (7117159296520514776, 61, 6), (18274021550817495445, 61, 6), (13727299168086049195, 61, 6),
            (16538406093887400796, 61, 6), (16000979246622866024, 61, 6), (6327214786821731584, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (17567252580019487012, 61, 6), (6832135972552633477, 61, 6), (3630686125488351669, 61, 6),
            (15039454296998256764, 61, 6), (17547489404434123741, 61, 6), (13091520385260273876, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (14830607191055830002, 61, 6), (17592637763253532166, 61, 6), (3895594429374158436, 61, 6),
            (680074962863235798, 61, 6), (3381105260553536201, 61, 6), (10392709593075757212, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (8528233392677543979, 61, 6), (141367783831796511, 61, 6), (6399230240824700563, 61, 6),
            (16590635218472634631, 61, 6), (15686365547812678270, 61, 6), (2067953820955746058, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (12804627144026968367, 61, 7), (5643327879443035527, 61, 6), (8762413838481785901, 61, 6),
            (9132855060806993982, 61, 6), (13450132694941235367, 61, 6), (9315920743570544245, 61, 6), (0, 0, 0),
        },
        {
            (0, 0, 0), (13178580938083523707, 61, 6), (14145731737671905986, 61, 6), (14122070735556889435, 61, 6),
            (11405266742692371132, 61, 6), (9027007398236230361, 61, 6), (1899729903858957730, 61, 6), (0, 0, 0),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] RookBitboardNumbers =
    {
        {
            (4776160871905344290, 50, 16378), (10739413405786423415, 50, 16362), (11023300171159986142, 50, 16365),
            (778771241257418790, 50, 16372), (8608959519917862722, 50, 16367), (169030602915422738, 50, 16358),
            (6594148728244692993, 50, 16340), (10912605024846226283, 49, 32751),
        },
        {
            (8286327781130338006, 50, 16359), (1375365997276489893, 51, 8151), (17350946975598583248, 51, 8167),
            (8741977211563767418, 51, 8172), (13285219267026807974, 51, 8174), (511406524781738372, 51, 8091),
            (9669360350658424908, 51, 8180), (7579780198980105788, 49, 32706),
        },
        {
            (12681121681577071978, 51, 8179), (84971149704183248, 51, 8172), (14002509729931334907, 51, 8181),
            (10301750353131522089, 51, 8170), (2941225861463621455, 51, 8183), (2059493372061308140, 51, 8180),
            (5663053191647600030, 51, 8183), (3905725450431199190, 49, 32730),
        },
        {
            (4370709106201172058, 50, 16364), (11959684685184448540, 51, 8176), (1225929989888347348, 50, 16328),
            (5486740316671204869, 51, 8183), (6619767218748371796, 51, 8179), (11036153035672708105, 51, 8189),
            (7565529312677494683, 50, 16272), (1532672166384878969, 49, 32732),
        },
        {
            (8484248100282163330, 50, 16368), (1772036509031502511, 51, 8178), (15008589811589880812, 51, 8177),
            (12430006422883278409, 50, 16331), (2255722817876751563, 50, 16334), (14571602653521652496, 51, 8188),
            (3278655462961128217, 50, 16262), (9830152429939049064, 49, 32730),
        },
        {
            (1913501495495850190, 50, 16354), (14298639819250644918, 50, 16337), (3740671019138484237, 51, 8171),
            (6755207380776885138, 51, 8179), (10034992483795358315, 51, 8187), (17778419104083832891, 51, 8158),
            (12700192430949997001, 51, 8187), (969642187429054322, 49, 32724),
        },
        {
            (18254462650521669628, 50, 16344), (3288012542843405869, 51, 8170), (15109812512395690153, 51, 8175),
            (1423393843949232254, 51, 8161), (10776201378061317650, 51, 8163), (6270423351662496329, 51, 8172),
            (1733527436224174464, 51, 8175), (8669964132318294510, 50, 16368),
        },
        {
            (12720606601267108678, 50, 16381), (4991175960356132680, 50, 16354), (9737924622733385295, 51, 8185),
            (7410816317468567234, 50, 16368), (11140965120839219794, 50, 16299), (2931852356533728539, 50, 16363),
            (16643468869408528266, 50, 16356), (1716635639174294565, 49, 32758),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] BishopBitboardNumbers =
    {
        {
            (1246223794379341870, 56, 254), (18110428880825487952, 57, 119), (1081705161565886587, 57, 119),
            (12466654829669525030, 57, 119), (2639142502319440844, 57, 117), (6932645723420947489, 57, 116),
            (11385276983033734023, 58, 63), (17875355939792504283, 56, 241),
        },
        {
            (7657770018142334795, 57, 110), (16784517929554287327, 57, 109), (14243563740150026220, 57, 116),
            (13532191952579066340, 57, 111), (5432013727164444846, 57, 110), (8505712883614631768, 57, 119),
            (540336047994126878, 57, 120), (3948195048683383712, 57, 120),
        },
        {
            (7858274979078264403, 57, 119), (824545012586910468, 58, 63), (17245751438346914639, 54, 1003),
            (10571373745055973861, 54, 1001), (13437605349913914478, 55, 509), (14065352022247056696, 55, 509),
            (5957629905160438992, 57, 117), (10323091737288913173, 57, 119),
        },
        {
            (11089167258923887579, 57, 115), (2762190219043905619, 57, 119), (3732256972203232956, 55, 504),
            (3930129415098642200, 51, 8161), (17760234730476459601, 51, 8154), (9411612391360231422, 55, 505),
            (6513024637729270153, 57, 121), (18373341486919970570, 57, 118),
        },
        {
            (7355235655210366382, 57, 120), (6184453432167107496, 58, 63), (5481439055917914890, 54, 995),
            (454981289159241918, 51, 8141), (16323308542095218556, 52, 4091), (10760992295056249192, 54, 996),
            (9631558442308575182, 57, 120), (2583318167047981599, 57, 123),
        },
        {
            (15044137228056331644, 57, 119), (415062410482909271, 58, 63), (15508728479994251269, 54, 995),
            (12585607335831940967, 54, 990), (6096132541943287388, 54, 963), (11612457469163021329, 55, 502),
            (10210834060520162833, 57, 120), (3966072745618309000, 57, 118),
        },
        {
            (1942868204329953313, 57, 118), (727583753940868797, 57, 116), (17678860410571606650, 57, 112),
            (17004551946595793642, 57, 115), (13987345156343769903, 57, 121), (8899482143960210036, 57, 116),
            (10753338287945811464, 57, 103), (8821222658983392788, 57, 113),
        },
        {
            (9628131152551507350, 56, 249), (5521088267136507069, 57, 120), (13566074736165161151, 57, 109),
            (13715871764772297176, 57, 118), (4995589448543968194, 57, 121), (9804653993436334995, 57, 118),
            (8715582697387566327, 57, 110), (10133489366041895025, 56, 250),
        },
    };

    public static readonly (ulong magicNumber, int push, int highest)[,] BlockCaptureNumbers =
    {
        {
            (18136888912697211626, 58, 62), (2327069326096191879, 57, 100), (9456527000067137200, 57, 104),
            (10865967477044399713, 57, 108), (10359779645723084586, 57, 102), (6494896923027211186, 57, 104),
            (9378912358530129295, 57, 96), (84027097421675217, 57, 106),
        },
        {
            (4055795232487741206, 57, 104), (16002565628273267727, 57, 106), (3370526387698445648, 57, 114),
            (4521703657773097568, 57, 108), (2175706653370279854, 57, 113), (6119433290913650709, 57, 118),
            (10165918689939948891, 57, 105), (3214066448800197296, 57, 106),
        },
        {
            (16062989174638359862, 57, 106), (9700387462191822410, 57, 102), (12449636378826830225, 57, 124),
            (8347637063444780191, 57, 123), (13271715888149328563, 57, 116), (7868294918068875179, 57, 119),
            (2696251112125072692, 57, 112), (1254309004787544647, 57, 104),
        },
        {
            (17408305243318783274, 57, 105), (16570061076404232868, 57, 113), (11792128150782507180, 57, 120),
            (1435141632047385112, 57, 122), (5296770345355023106, 56, 214), (10300835576912597249, 57, 119),
            (5578922241275832194, 57, 112), (2942573297585983507, 58, 61),
        },
        {
            (14719795838756471459, 57, 105), (11003521612996777270, 57, 116), (3737263062813082529, 57, 116),
            (8010079062853919914, 57, 126), (12889812774857358090, 56, 217), (51920667714283773, 57, 119),
            (9522624857863144221, 57, 114), (10996040799672870028, 57, 103),
        },
        {
            (14186968048679444915, 57, 108), (5019666570504419681, 57, 116), (1047419846151254727, 57, 112),
            (12122544807142911210, 57, 119), (547270539872942409, 57, 121), (13005235555093303131, 57, 124),
            (12149855763196931816, 57, 119), (11175764748654214797, 57, 110),
        },
        {
            (4069264438024245166, 58, 62), (16259809951805547453, 57, 112), (8565696072437156541, 57, 120),
            (10009401415298627760, 57, 116), (7118199255673178519, 57, 100), (11865414316170283415, 57, 107),
            (17988224065653672613, 57, 113), (6076724263280802250, 57, 100),
        },
        {
            (1730556494151492078, 58, 62), (12855315494560746201, 57, 100), (15606222225023585950, 57, 106),
            (10464506638414697203, 57, 94), (3995429928638883866, 57, 104), (14441080048848523022, 57, 92),
            (5098129475721629, 57, 103), (9830638387599035980, 57, 97),
        },
    };
}